{% load static %}

<div class="exitblock">
    <div class="fon"></div>
    <div class="modaltext">
        <strong class="popup__title">Получить выгодное предложение</strong>
        <form action="#" method="post" class="popup__form site-form"
              data-dev data-popup-message="#form-message" autocomplete="off">
            {% csrf_token %}
            <label for="popupName" class="popup__label">
                <input id="popupName" type="text" name="name" data-error="Поле не заполнено!"
                       data-required="text" autocomplete="off" placeholder="Имя" class="popup__input">
            </label>
            <label for="popupTel" class="popup__label">
                <input id="popupTel" type="text" name="phone" data-error="Поле не заполнено!"
                       data-required="phone" placeholder="+7(000)000-00-00" class="popup__input">
            </label>
            <button type="submit" class="popup__button btn-blue">Заказать звонок</button>
            <div class="popup__checkbox checkbox-form">
                <input id="checkBoxPopup" value="1" data-error="Требуется поставить галочку!"
                       data-required="checkbox" type="checkbox" class="checkbox-form__input" checked
                       name="form[]">
                <label for="checkBoxPopup" class="checkbox-form__label">
                    <span class="checkbox-form__text">Нажимая на кнопку, вы даете согласие на <a href="#">обработку персональных данных</a></span>
                </label>
            </div>
        </form>
    </div>
    <div class="closeblock">+</div>
</div>

<style>
    .exitblock {
        display: none;
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        z-index: 1000;
    }

    .exitblock .fon {
        background: #F6FCFF;
        opacity: .8;
        position: fixed;
        width: 100%;
        height: 100%;
    }

    .exitblock .modaltext {
        box-sizing: border-box;
        padding: 20px 40px;
        border: 2px solid #AEAEAE;
        border-radius: 20px;
        background: #F6FCFF;
        position: fixed;
        top: 80px;
        left: 64%;
        margin-left: -30%;
        width: 30%;
        box-shadow: 0 4px 10px 2px rgba(0, 0, 0, 0.5);
    }

    .closeblock {
        cursor: pointer;
        position: relative;
        line-height: 60px;
        font-size: 82px;
        transform: rotate(45deg);
        text-align: center;
        top: 10%;
        right: -12%;
        color: #337AB7;
    }

    .closeblock:hover {
        color: #000;
    }
</style>

<script>
    function exitPopup() {
        $(document).mouseleave(function (e) {
            if (e.clientY < 10) {
                $(".exitblock").fadeIn("fast");
            }
        });
        $(document).click(function (e) {
            if (($(".exitblock").is(':visible')) && (!$(e.target).closest(".exitblock .modaltext").length)) {
                $(".exitblock").remove();
            }
        });
        localStorage.setItem('exitPopup', 'true');
    }

    if (localStorage.getItem('exitPopup') === null) {
        exitPopup();
    }
</script>